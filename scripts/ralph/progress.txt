# Ralph Progress Log
Started: Sat Feb 1 14:00:00 CET 2026

## Codebase Patterns
- gSnake is a monorepo with submodules: gsnake-levels (Rust), gsnake-web (Svelte/TypeScript), gsnake-specs (Markdown), gsnake-editor (Svelte/TypeScript)
- Each submodule has its own build system and tooling
- Git submodules must be committed separately before the main repo
- Always include scripts/test/result.txt in commits per Ralph instructions

---
## 2026-02-01 15:35 - US-001
- Created .github/hooks/ directory in gsnake-levels submodule
- Added README.md with instructions for enabling/disabling hooks
- Verified typecheck passes with cargo check
- Committed and pushed to gsnake-levels submodule

**Files changed:**
- gsnake-levels/.github/hooks/README.md (new)

**Learnings for future iterations:**
- Must work inside the specific submodule directory (was already in gsnake-levels/)
- Submodules must be committed separately before committing to main repo
- Git submodule commits need to be pushed individually
- README.md provides clear instructions for opt-in hook setup using `git config core.hooksPath .github/hooks`
---
## 2026-02-01 16:00 - US-002
- Created pre-commit hook script in gsnake-levels/.github/hooks/pre-commit
- Hook runs cargo fmt, clippy, check, and build without tests
- Fixed clippy warnings in build.rs (needless borrow), verify_all.rs (ptr_arg), and verify.rs (unnecessary_literal_unwrap)
- Applied cargo fmt to all files to ensure consistency
- Committed and pushed to gsnake-levels submodule

**Files changed:**
- gsnake-levels/.github/hooks/pre-commit (new, executable)
- gsnake-levels/build.rs (clippy fix)
- gsnake-levels/src/verify_all.rs (clippy fix + import Path)
- gsnake-levels/src/verify.rs (clippy fix)
- Multiple source files (cargo fmt applied)

**Learnings for future iterations:**
- Pre-commit hooks must be executable (chmod +x)
- Rust clippy with -D warnings is strict and catches subtle issues like needless borrows and ptr_arg
- The hook script uses `set -e` to exit on first failure
- Tests are explicitly excluded from pre-commit hook for speed
- When fixing clippy issues, watch for missing imports (e.g., Path when changing &PathBuf to &Path)
---
## 2026-02-01 16:30 - US-003
- Created .github/hooks/ directory in gsnake-web submodule
- Added README.md with instructions for enabling/disabling hooks
- Verified typecheck passes with npm run check
- Committed and pushed to gsnake-web submodule
- Updated main repo with submodule reference

**Files changed:**
- gsnake-web/.github/hooks/README.md (new)
- gsnake-web submodule commit reference

**Learnings for future iterations:**
- gsnake-web uses svelte-check for typechecking (npm run check)
- The README structure should match other submodules for consistency
- Working directory was already in gsnake-web when starting this story
---
## 2026-02-01 17:00 - US-004
- Added build:hook script to gsnake-web/package.json
- Script runs `node scripts/build-wasm.js && vite build` to bypass prebuild test hook
- Verified build:hook completes successfully without running tests
- Typecheck passes with svelte-check
- Committed and pushed to gsnake-web submodule and main repo

**Files changed:**
- gsnake-web/package.json (added build:hook script)

**Learnings for future iterations:**
- The prebuild hook in package.json runs automatically before the build script
- To skip prebuild hooks, create a separate script that calls the underlying commands directly
- The build:hook script includes build-wasm.js to ensure WASM is built before vite build
- This pattern allows pre-commit hooks to run builds without triggering test suites
---
## 2026-02-01 17:30 - US-005
- Created pre-commit hook script in gsnake-web/.github/hooks/pre-commit
- Hook runs prettier format check, svelte-check typecheck, and build:hook without tests
- Fixed formatting issues across 25 files with prettier --write
- Lint check with eslint was skipped because the project doesn't have eslint configured
- Hook successfully passes all available checks: formatting, typecheck, and build
- Committed and pushed to gsnake-web submodule and main repo

**Files changed:**
- gsnake-web/.github/hooks/pre-commit (new, executable)
- 25 files in gsnake-web reformatted with prettier (workflows, CSS, TypeScript, config files)

**Learnings for future iterations:**
- Pre-commit hooks must be executable (chmod +x)
- Not all projects have eslint configured - check before adding lint step
- Use npx to run tools not installed in devDependencies (prettier, eslint)
- Run prettier --write to fix formatting before committing
- The hook uses `set -e` to exit on first failure
- Tests are explicitly excluded from pre-commit hooks for speed
- gsnake-web uses npx prettier for formatting and npm run check for typecheck
---
## 2026-02-01 16:45 - US-006
- Created .github/hooks/ directory in gsnake-specs submodule
- Added README.md with instructions for enabling/disabling hooks
- Verified that the markdown structure is valid
- Committed and pushed to gsnake-specs submodule

**Files changed:**
- gsnake-specs/.github/hooks/README.md (new)

**Learnings for future iterations:**
- gsnake-specs is a Markdown-only repository without traditional typecheck commands
- The "typecheck passes" requirement for Markdown repos means ensuring changes don't break anything
- README structure matches the pattern used in gsnake-levels and gsnake-web for consistency
- gsnake-specs submodule commit reference needs to be updated in main repo
---
